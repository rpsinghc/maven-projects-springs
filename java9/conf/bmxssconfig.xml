<?xml version="1.0" encoding="ISO-8859-1" ?>
<xss-config>
    <xss-conditions>
    	<!--
    		The default xss-conditions look for possible elements patterns such as any string starting with "<" symbol. 
    		If the pattern is matched against the input data, then the data will be passed to the xss handler for sanitization. 
    		In case there is no element pattern found in the given data, then uses the "unmatched-content-action-type" 
    		attribute to take further actions on the data.
    		
    		Allowed values for unmatched-content-action-type are:
			
			1)	HTML_ESCAPE  - Escapes the characters in the input data using HTML entities
			2)	NO_ACTION - No action will be taken on the input data and it is returned as it is.
    	-->
        <element-detection-pattern unmatched-content-action-type='HTML_ESCAPE'>(.*&lt;([^\s].*)&gt;?.*)</element-detection-pattern>
    </xss-conditions>

    <xss-actions>
		<!-- 
			What action to take on the tags that are not accepted. The possible values could be:
			FILTER -> remove the tag, but keep the content
			REMOVE -> Remove tag along with the content in it
			ENCODE -> encode the tag, so that the tag with the content is displayed but not executed (default)
			THROW_EXCEPTION -> Throw exception to the user (not recommended)
			APPLY_CDATA -> apply the content with the CDATA tag
		-->
        <unaccepted-tag-action-type>ENCODE</unaccepted-tag-action-type>

		<!--
			What action to take on the attributes that are not accepted. The possible values could be:
			REMOVE, THROW_EXCEPTION, ENCODE_VALUE
			Default is REMOVE 
		-->
        <unaccepted-attribute-action-type  enabled='true'>REMOVE</unaccepted-attribute-action-type>
    </xss-actions>
	
    <xss-rules>
        <import file='resources/conf/bmwebsecurity/bmxsshtml4rules.xml' name="xss-default-html4"/>
        
        <!--
        <accept-common-attr name="align">
            <regexp>center|left|right</regexp>
            <regexp>center|left|right</regexp>
            <except-tag name='a'/>
        </accept-common-attr>

        <accept-tag name="b">
            <attr name="href">
                <regexp>http://abc.com/*</regexp>
                <regexp>http://abc1.com/*</regexp>
            </attr>
        </accept-tag>
		
        <reject-tag name='script'/>
        <reject-common-attr name='href'/>
        <reject-tag name="a">
            <attr name="href"/>
        </reject-tag>
        -->
    </xss-rules>

    <!-- 
		exclude-url-patterns defines all urls that must be excluded from checking the XSS attacks.
		Each URL should be relative to the context path of the portal application. Individual url-pattern elements 
		uses the ANT style pattern expression.
	-->
    <exclude-url-patterns>
        <url-pattern>/**/*.css</url-pattern>
        <url-pattern>/**/*.js</url-pattern>
        <url-pattern>/**/*.png</url-pattern>
        <url-pattern>/**/*.gif</url-pattern>
        <url-pattern>/**/*.swf</url-pattern>
        <url-pattern>/bpmportal/myhome/*.portal</url-pattern>
		<url-pattern>/bpmportal/common/repeatsection/*.portal</url-pattern>
		<url-pattern>/bpmportal/common/bosection/*.portal</url-pattern>
		<url-pattern>/bpmportal/common/forms/*.form</url-pattern>
		
		
		
    </exclude-url-patterns>
	
</xss-config>
