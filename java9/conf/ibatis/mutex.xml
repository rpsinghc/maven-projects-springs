<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap 
PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="mutex">

	<resultMap id="lockInfo" class="com.worldcheck.atlas.sbm.ibatis.LockInfoVO">
		<result property="crn" column="CRN" />
		<result property="ipAddress" column="IP_ADDR" />
	</resultMap>

	<parameterMap class="com.worldcheck.atlas.sbm.ibatis.LockInfoVO"
		id="lockInsertInfo">
		<parameter property="crn" />
		<parameter property="ipAddress" />
	</parameterMap>

	<select id="GET_LOCK_INFO" resultClass="java.lang.String"
		parameterClass="java.lang.String">
		select ip_addr from cms_mutext_lock where
		crn=#crn#
	</select>

	<insert id="INSERT_LOCK_INFO" parameterClass="java.util.Map">
		insert into
		cms_mutext_lock (crn,ip_addr) values (#crn#,#ipAddress#)
	</insert>

	<delete id="RELEASE_LOCK" parameterClass="java.lang.String">
		delete from
		cms_mutext_lock where crn=#crn#
	</delete>

	<update id="updateCaseStatus" parameterClass="java.util.Map">
		update
		cms_clientcase
		set case_status_id = (select CASE_STATUS_ID from
		CMS_CASE_STATUS_MASTER where DESCRIPTION = (#caseStatus#)),
		updated_by
		= #updatedBy#,
		UPDATED_ON = SYSDATE
		where crn = #crn#
   </update>

</sqlMap>
