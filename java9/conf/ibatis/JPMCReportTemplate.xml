<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL MAP 2.0//EN" 
	"http://www.ibatis.com/dtd/sql-map-2.dtd">
<sqlMap namespace="JPMCReportTemplate">

	<select id="refreshTimeJPMCDailyReports"
		parameterClass="com.worldcheck.atlas.vo.MaterializedViewVO" resultClass="com.worldcheck.atlas.vo.MaterializedViewVO">
			SELECT mview_name, to_char(LAST_REFRESH_DATE, 'dd-Mon-yyyy hh24:mi:ss') startTime,
			CASE
			  WHEN fullrefreshtim <![CDATA[ <> ]]> 0 THEN
				to_char( LAST_REFRESH_DATE + fullrefreshtim/60/60/24, 'dd-Mon-yyyy hh24:mi:ss')
			  WHEN increfreshtim <![CDATA[ <> ]]> 0 THEN
				to_char( LAST_REFRESH_DATE + increfreshtim/60/60/24, 'dd-Mon-yyyy hh24:mi:ss')
			  ELSE
				 to_char(LAST_REFRESH_DATE, 'dd-Mon-yyyy hh24:mi:ss')
			END as endTime,
			fullrefreshtim fullrefreshtime,increfreshtim increfreshtime
			FROM all_mview_analysis
			<isNotNull property="mvList">
			<isNotEmpty  prepend="where" property="mvList">
				mview_name in 
				<iterate property="mvList" open="(" close=")" conjunction=",">
					#mvList[]#
				</iterate> 
			</isNotEmpty>
		</isNotNull>
     </select> 
     
     <select id="getDailyJpmcExportData" parameterClass="com.worldcheck.atlas.vo.masters.JPMCReportAppVO" resultClass="com.worldcheck.atlas.vo.masters.JPMCReportAppVO">
			SELECT  CASE_REFERENCE_NO,	
				    CLIENT_CODE,
				    CLIENT_NAME,
					CASE_STATUS,
					CASE_FEE,
					REQUEST_RECEIVED_DATE,
					FINAL_DUE_DATE,
					CLIENT_FINAL_SENTDATE,
					SUBJECT_TYPE,
					SUBJECT_NAME,
					SUBJECT_COUNTRY,
					OTHER_DETAILS,
					RESEARCH_ELEMENT_ORIGINAL 
			FROM JPMC_DAILY_REPORTS_MV 
			WHERE
			CLIENT_CODE = #client_code#
			 order by CASE_REFERENCE_NO
			
		 </select>
</sqlMap>
